---
title: "[ë„¤ì´ë²„ ë¶€ìŠ¤íŠ¸ ìº í”„] AI-Tech - Lv2 week4(4)"
categories: AI boostcourse
tags: python
published: true
use_math: true
---

## í•™ìŠµê¸°ë¡ - 42

ì˜¤ëŠ˜ í•  ì¼  

- Neck

## 1. ê°•ì˜ ë³µìŠµ ë‚´ìš©

### Neck

- Neckì€ ë¬´ì—‡ì¸ê°€?

Background
ë¨¼ì € ì´ì „ì— ë‹¤ë£¨ì—ˆë˜ 2-Stages Modelì€ ë‹¤ìŒê³¼ ê°™ìŠµë‹ˆë‹¤.
RoI ( feature map â†’ RPN ) + Feature map â†’ Prediction

![Untitled](/assets/images/AI-Images2/lv2_week2_3/img37.png){: width="50%" height="50%"}  
![Untitled](/assets/images/AI-Images2/lv2_week2_4/img0.png){: width="50%" height="50%"}  

![Untitled](/assets/images/AI-Images2/lv2_week2_4/img1.png){: width="50%" height="50%"}  

ì—¬ê¸°ì„œ ë§ˆì§€ë§‰ feature mapë§Œì´ ì•„ë‹Œ ì¤‘ê°„ feature mapë„ ì´ìš©í•˜ì! â†’ 'Neck'

![Untitled](/assets/images/AI-Images2/lv2_week2_4/img2.png){: width="50%" height="50%"}  

- Neckì€ ì™œ í•„ìš”í•œê°€?

  Image ì•ˆì—ëŠ” ë‹¤ì–‘í•œ í¬ê¸°ì˜ ê°ì²´ë“¤ì´ ì¡´ì¬í•œë‹¤. ì¼ë°˜ì ìœ¼ë¡œ backboneì˜ ëª¨ë“  layerë¥¼ í†µê³¼í•œ í›„ì—” semanticí•œ ì •ë³´ë¥¼ ê°€ì§ˆ ìˆ˜ ìˆëŠ” ë°ì— ë¹„í•´, 

  high-levelì˜ feature-mapì€ ì‘ì€ í¬ê¸°ì˜ ê°ì²´ë¥¼, low-levelì˜ feature mapì€ í° í¬ê¸°ì˜ ê°ì²´ë¥¼ ì˜ ì¡ì•„ë‚¼ ìˆ˜ ìˆë‹¤.

  â†’ **ë‹¤ì–‘í•œ ê°ì²´ë¥¼ íƒì§€í•˜ê¸° ìœ„í•´ì„œ neckì´ í•„ìš”**í•˜ë‹¤. (í˜„ì¬ê¹Œì§€ë„ ì‘ì€ ê°ì²´ëŠ” ì œëŒ€ë¡œ íƒì§€í•˜ì§€ ëª»í•˜ëŠ” ë¬¸ì œë¥¼ ê°€ì§€ê³  ìˆë‹¤.)

    ![Untitled](/assets/images/AI-Images2/lv2_week2_4/img3.png){: width="50%" height="50%"}  

  High-level

    ![Untitled](/assets/images/AI-Images2/lv2_week2_4/img4.png){: width="50%" height="50%"}  

    Low-level

    Neckì´ë¼ëŠ” ëª¨ë“ˆì„ ë‘ì§€ ì•Šê³  Regionìœ¼ë¡œ ë½‘ì„ ìˆ˜ ìˆì§€ ì•Šì„ê¹Œ?

    â†’ Highs level : Semantic ğŸ‘ local ğŸ‘  
      Low level    : Semantic ğŸ‘ local ğŸ‘

    â†’ High level feature ì™€ Low level feature ì˜ êµí™˜ì´ í•„ìš”í•˜ë‹¤. 

- FPN (Feature Pyramid Network (FPN)
  - ì—¬ëŸ¬ ì‹œë„ë“¤

    ![Untitled](/assets/images/AI-Images2/lv2_week2_4/img5.png){: width="50%" height="50%"}  

  - high-level â†’ low-levelë¡œ semantic ì •ë³´ ì „ë‹¬ (top-down path way ì¶”ê°€)

     ![Untitled](/assets/images/AI-Images2/lv2_week2_4/img6.png){: width="50%" height="50%"}  

    ì–´ë–»ê²Œ í•˜ëŠ” ê²ƒì¼ê¹Œ?

  - Lateral connections

    Bottom-Upì—ì„œ ë‚˜ì˜¨ feature map â†’ 1x1 conv

    Top - Down ì˜ feature map â†’ 2x upsampling

    ìœ„ ë‘˜ì˜ í•©ì„ ì´ìš©í•´ì„œ ì„œë¡œì˜ ì •ë³´ë¥¼ ì–»ëŠ”ë‹¤.

      ![Untitled](/assets/images/AI-Images2/lv2_week2_4/img7.png){: width="50%" height="50%"}  

      ![Untitled](/assets/images/AI-Images2/lv2_week2_4/img8.png){: width="50%" height="50%"}  

    UpSampling ë°©ë²•ì€ Nearest Neighbor Upsamplingì˜ ë°©ë²•ì„ ì´ìš©í•œë‹¤. 

      ![Untitled](/assets/images/AI-Images2/lv2_week2_4/img9.png){: width="50%" height="50%"}  

  - Pipeline

    ResNetì„ Backboneìœ¼ë¡œ í–ˆì„ ë•Œ ê° layerì—ì„œ ìƒì„±ë˜ëŠ” feature mapì— 1by1 convolution í•œ feature map (local ì •ë³´), 2x upsampling (semantic ì •ë³´) ë¥¼ í•©í•œ í›„ (**Lateral connections**), â†’ P5, P4, P3, P2ê°€ ë‚˜ì˜¤ê²Œ ë©ë‹ˆë‹¤. 

    Stageë¥¼ í†µí•´ ë‚˜ì˜¨ P5~P2ë¥¼ RPNì„ í†µê³¼í•œ í›„, ê° Stageì—ì„œ RoIê°€ ë§ì´ ë‚˜ì˜¤ê²Œ ë˜ê³ , NMSë¥¼ í†µí•´ 1000ê°œì˜ RoI ì¶”ì¶œí•œë‹¤. í•˜ì§€ë§Œ, ì´ì „ê³¼ëŠ” ë‹¤ë¥´ê²Œ RoIê°€ ì–´ë–¤ Stageì—ì„œ ì™”ëŠ”ì§€ mappingì´ í•„ìš”í•˜ë‹¤.

      ![Untitled](/assets/images/AI-Images2/lv2_week2_4/img10.png){: width="50%" height="50%"}  

    Mappingì„ ìœ„í•´ ì•„ë˜ì™€ ê°™ì€ ê³µì‹ì„ ì´ìš©í•´ì„œ ìµœì¢… Stageë¥¼ ê³„ì‚°í•˜ê²Œ ëœë‹¤. (k_0 : stageì˜ ê°œìˆ˜) ìµœì¢… Stage ê³„ì‚°ì„ í†µí•´ í•´ë‹¹ feature mapì— ëŒ€í•´ RoI Projectionì„ ì§„í–‰í•œë‹¤.

    kê°€ í´ìˆ˜ë¡ ë†’ì€ Stageì— ìˆê³ , kê°€ ì‘ì„ìˆ˜ë¡ ì‘ì€ Stageì— ìˆê²Œ ëœë‹¤.

      $$k = [k_0 + log_2(\sqrt{w h}/224)]$$

  - Summary
    - FPNì€ ì—¬ëŸ¬ scaleì˜ ë¬¼ì²´ë¥¼ íƒì§€í•˜ê¸° ìœ„í•´ ì„¤ê³„í–ˆê³ , ì´ë¥¼ ë‹¬ì„±í•˜ê¸° ìœ„í•´ì„œ ì—¬ëŸ¬ í¬ê¸°ì˜ featureë¥¼ ì‚¬ìš©í•´ì•¼í•  í•„ìš”ê°€ ìˆìŠµë‹ˆë‹¤.
    - ì´ë¥¼ ìœ„í•´, Bottom up (Backbone)ì—ì„œ ë‹¤ì–‘í•œ í¬ê¸°ì˜ feature mapì„ ì¶”ì¶œ,
    - ë‹¤ì–‘í•œ í¬ê¸°ì˜ feature mapì˜ semanticì„ êµí™˜í•˜ê¸° ìœ„í•´ top-down ë°©ì‹ ì‚¬ìš© ( êµí™˜? )
    - small box íƒì§€ì—ì„œ í° íš¨ê³¼ë¥¼ ë³´ì—¬ì¤€ë‹¤.

      ![Untitled](/assets/images/AI-Images2/lv2_week2_4/img11.png){: width="50%" height="50%"}  

  - Code
    - Build laterals : ê° feature map ë§ˆë‹¤ ë‹¤ë¥¸ ì±„ë„ì„ ë§ì¶°ì£¼ëŠ” ë‹¨ê³„

      Build Top-down : channelì„ ë§ì¶˜ í›„ top-down í˜•ì‹ìœ¼ë¡œ feature map êµí™˜

      Build outputs : ìµœì¢… 3x3 convolutionì„ í†µê³¼í•˜ì—¬ RPNìœ¼ë¡œ ë“¤ì–´ê°ˆ feature ì™„ì„±

        ```python
        # build laterals
        laterals = 
        [lateral_conv(inputs[i]) for i, lateral_conv in enumera(self.laterals_conv)]
        # build top-down
        for i in range(3,0,-1):
        		prev_shape = laterals[i-1].shape[2:]
        		laterals[i-1] += F.interpolate(laterals[i], size=prev_shape)
        # build outputs
        outs = [self.fpn_convs[i](laterals[i]) for i in range(4)]
        ```

- PANet (Path Aggregation Network)
  - Problem in FPN : **Bottom-up Path Augmentation**

    Bottom-up ê³¼ì •ì—ì„œ ì‹¤ì œë¡œ ResNetì„ ì´ìš©í•œë‹¤ë©´, ì •ë³´ ì „ë‹¬ì´ high-levelê¹Œì§€ ì œëŒ€ë¡œ ì „ë‹¬ë  ìˆ˜ ì—†ë‹¤. ì¦‰, low-levelì˜ local ì •ë³´ê°€ high-level ìª½ì—ì„œëŠ” ì‚¬ë¼ì§ˆ ìˆ˜ ìˆë‹¤.

    ë”°ë¼ì„œ, low-level ì •ë³´ë¥¼ ìµœëŒ€í•œ ë³´ì¡´í•˜ê¸° ìœ„í•´ì„œ Bottom-up Path Augmentation ë°©ì‹ì„ ì‚¬ìš©í•œë‹¤. ( ë¹¨ê°„ìƒ‰ ì ì„ ì€ ê¸°ì¡´ FPN, ì´ˆë¡ìƒ‰ ì ì„ ì€ PANetì˜ ì •ë³´ íë¦„)

      ![Untitled](/assets/images/AI-Images2/lv2_week2_4/img12.png){: width="50%" height="50%"}  

      ![Untitled](/assets/images/AI-Images2/lv2_week2_4/img13.png){: width="50%" height="50%"}  

    FPNì´ ìƒì„±í•œ {P2, P3, P4, P5}ë¥¼ í™œìš©í•˜ì—¬ {N2, N3, N4, N5}ì„ ìƒì„±í•  ë•ŒëŠ”, 3x3 stride = 2ì¸ conv layerë¥¼ ê±°ì³ì„œ down-samplingí•˜ê³  P_(i+1)ê³¼ lateral connectionì„ í†µí•´ N_(i+1) feature mapì„ ìƒì„±í•©ë‹ˆë‹¤. 

  - **Adaptive Feature Pooling**

    N2~N5ëŠ” ê°ê° RPNì„ ê±°ì³ì„œ RoIë¥¼ ìƒì„±í•˜ê²Œ ë©ë‹ˆë‹¤. ê·¸ë¦¬ê³  RoI Align(RoI Pooling)ì„ í†µí•´ì„œ ì¼ì •í•œ í¬ê¸°ì˜ vectorê°€ ìƒì„±ë©ë‹ˆë‹¤. 

    ì™œ?)

    FPN ë¬¸ì œì 1) : ì´ì „ì— ë§í–ˆë˜ ê³µì‹ì„ ì´ìš©í•´ì„œ Stageë¥¼ ì°¾ê²Œ ëœë‹¤ë©´, 10px ì°¨ì´ì—ë„ stage ì„ íƒì— ì°¨ì´ê°€ ë‚˜ê²Œ ë©ë‹ˆë‹¤. (feature mapì˜ ì°¨ì´)

      $$k = [k_0 + log_2(\sqrt{w h}/224)]$$

    FPN ë¬¸ì œì 2) : ëª¨ë“  RoIë¥¼ ë½‘ì€ ë‹¤ìŒì— (1000ê°œ) Select Nê°œë¥¼ í•´ì„œ íŠ¹ì • Stageì˜ Feature mapì— ëŒ€í•´ RoIë¥¼ Projection í•  ìˆ˜ ìˆê²Œ ë§Œë“¤ì—ˆë‹¤. 

      ![Untitled](/assets/images/AI-Images2/lv2_week2_4/img10.png){: width="50%" height="50%"}  

    ìœ„ì˜ 2ê°œì˜ ë¬¸ì œì ì„ í•´ê²°í•˜ê¸° ìœ„í•´ì„œ N2~N5ì˜ ëª¨ë“  RoIë¥¼ ë½‘ì•„ë‚´ì„œ RoI Projectionsì„ ì§„í–‰í•˜ê³  RoI poolingì„ í•œ ì´í›„ì—, fc1ì„ ë§Œë“¤ì–´ì„œ max pooling ì—°ì‚°ìœ¼ë¡œ í•˜ë‚˜ë¡œ ê²°í•©í•©ë‹ˆë‹¤. í•˜ë‚˜ë¡œ ê²°í•©ëœ ë²¡í„°ì—ì„œ classì™€ boxë¥¼ ì˜ˆì¸¡í•©ë‹ˆë‹¤.

      ![Untitled](/assets/images/AI-Images2/lv2_week2_4/img14.png){: width="50%" height="50%"}  

    (ì§ˆë¬¸) RoI projectionì„ ëª¨ë“  ê³³ì—ì„œ ì‹¤í–‰í•œë‹¤ë©´, ì—„ì²­ ë§ì€ ì–‘ì˜ box regressionì´ ì§„í–‰ë˜ëŠ”ê±´ê°€?

    - code
      - FPN : Top-downì— 3x3 convolution layer í†µê³¼í•˜ëŠ” ê²ƒê¹Œì§€ ë™ì¼
      - Add bottom-up : FPNì„ í†µê³¼í•œ í›„, bottom-up path ë¥¼ ë”í•´ì¤Œ
      - Build outputs : ì´í›„ FPNê³¼ ë§ˆì°¬ê°€ì§€ë¡œ í•™ìŠµì„ ìœ„í•´ 3x3 convolution layer í†µê³¼

        ```python
        # build outputs
        inter_outs = [ self.fpn_convs[i](laterals[i]) for i in range(4)
        # part 2: add bottom-up path
        for i in range(3):
        		inter_outs[i+1] += self.downsample_convs[i](inter_outs[i])
        # build outputs
        outs = []
        outs.append(inter_outs[0])
        outs.extend([self.pafpn_convs[i-1](inter_outs[i]) for i in range(1,4)])
        ```

- DetectoRS
  - Motivation - Looking and thinking twice â†’ ë¬´ì–¸ê°€ë¥¼ ë°˜ë³µì ìœ¼ë¡œí•˜ë©´ ì¢‹ì€ ì„±ëŠ¥ì´ ë‚˜ì˜¬ê¹Œ?
    - Region proposal networks (RPN)
    - Cascade R-CNN
  - RFP (Recursive Feature Pyramid)

    FPNì„ Recursiveí•˜ê²Œ ì§„í–‰í•œë‹¤!ë¼ê³  ìƒê°í•˜ì. Neck (Top-bottom) ë§Œì´ í•™ìŠµì„ í•˜ëŠ” ê²ƒì´ ì•„ë‹Œ, Neckì„ ì´ìš©í•´ì„œ ë‹¤ì‹œ Backboneì— í•™ìŠµì„ ì‹œí‚¬ ìˆ˜ ìˆë„ë¡ ë§Œë“ ë‹¤.

    (ë¬¸ì œì ) Full-loops(?)ê°€ ë§ì´ ìƒê²¨ì„œ ì—°ì‚°ëŸ‰ì´ ë§ì•„ì§„ë‹¤. í•™ìŠµ ì‹œê°„ì´ ë§¤ìš° ì˜¤ë˜ ê±¸ë¦°ë‹¤.

      ![Untitled](/assets/images/AI-Images2/lv2_week2_4/img15.png){: width="50%" height="50%"}  

    Pipelineì€ ë‹¤ìŒê³¼ ê°™ì´ ìˆ˜í–‰ë©ë‹ˆë‹¤. ì—¬ê¸°ì„œ Neckì—ì„œ ìˆ˜í–‰í–ˆë˜ ì •ë³´ë¥¼ ë‹¤ì‹œ Backboneìœ¼ë¡œ ë„˜ê²¨ì¤„ ë•Œ, ASPPë¼ëŠ” ê³¼ì •ì„ ì´ìš©í•´ì„œ ë„˜ê²¨ì£¼ê²Œ ë©ë‹ˆë‹¤. 

      ![Untitled](/assets/images/AI-Images2/lv2_week2_4/img16.png){: width="50%" height="50%"}  

    ASPP (Atros Spatial Pyramid Pooling) ë€, Atros convolutionì„ ì§„í–‰í•´ì„œ ë§Œë“  ì—¬ëŸ¬ layerë¥¼ concatí•´ì„œ ë§Œë“  ê²ƒì´ë‹¤. dilation rateë¥¼ ì—¬ëŸ¬ ê°€ì§€ë¡œ ì£¼ë©´ì„œ Recptive fieldë¥¼ ëŠ˜ë ¤ê°€ë©° Atros Convolutionì„ í•˜ê²Œ ëœë‹¤.

    Atros Convolutionì€ ë‹¤ìŒê³¼ ê°™ì´ dilation rateì— ë”°ë¼ kernel ì‚¬ì´ì— ì¹¸ì„ ë‘ê³  convolutionì„ í•œë‹¤. ì´ë¥¼ ì´ìš©í•˜ë©´ Receptive fieldê°€ ì»¤ì§€ëŠ” íš¨ê³¼ë¥¼ ë³¼ ìˆ˜ ìˆë‹¤.

    (ì§ˆë¬¸) Receptive fieldê°€ ì»¤ì§€ë©´ ì–´ë–¤ íš¨ê³¼ë¥¼ ì–»ì„ ìˆ˜ ìˆì„ê¹Œ?

      ![Untitled](/assets/images/AI-Images2/lv2_week2_4/img17.png){: width="50%" height="50%"}  

- BiFPN (Efficient Det)
  - Pipline

    Top-downì˜ ì²«ì§¸ ë…¸ë“œì™€ ë§ˆì§€ë§‰ ë…¸ë“œë¥¼  ì§€ì›Œì„œ ë‹¤ìŒê³¼ ê°™ì´ ë§Œë“¤ì–´ì¤ë‹ˆë‹¤.

      ![Untitled](/assets/images/AI-Images2/lv2_week2_4/img18.png){: width="50%" height="50%"}  

      ![Untitled](/assets/images/AI-Images2/lv2_week2_4/img19.png){: width="50%" height="50%"}  

    ì´ ë…¼ë¬¸ì—ì„œëŠ” FPNì˜ Lateral connectionsì— ë¬¸ì œë¥¼ ì œê¸°í–ˆë‹¤. High level ì—ì„œ ì˜¤ëŠ” Semantic ì •ë³´ì™€ Low level ì—ì„œ ì˜¤ëŠ” Local ì •ë³´ë¥¼ ë‹¨ìˆœíˆ **'summation'** í•œë‹¤ëŠ” ê²ƒì´ ë§ì§€ ì•Šë‹¤ëŠ” ê²ƒì´ë‹¤.


  - Weighted Feature Fusion
    - Featureë³„ë¡œ ê°€ì¤‘ì¹˜ë¥¼ í†µí•´ì„œ ì¤‘ìš”í•œ featureë¥¼ ê°•ì¡°í•˜ì—¬ ì„±ëŠ¥ì„ ìƒìŠ¹ì‹œí‚¤ì.

      í•™ìŠµ ë˜í•œ ê°€ëŠ¥í•  ìˆ˜ ìˆë„ë¡ í•œë‹¤.

        ![Untitled](/assets/images/AI-Images2/lv2_week2_4/img20.png){: width="50%" height="50%"}  

        $$\begin{aligned}P_{6}^{t d} &=\operatorname{Conv}\left(\frac{w_{1} \cdot P_{6}^{i n}+w_{2} \cdot \operatorname{Resize}\left(P_{7}^{i n}\right)}{w_{1}+w_{2}+\epsilon}\right) \\P_{6}^{\text {out }} &=\operatorname{Conv}\left(\frac{w_{1}^{\prime} \cdot P_{6}^{i n}+w_{2}^{\prime} \cdot P_{6}^{t d}+w_{3}^{\prime} \cdot \operatorname{Resize}\left(P_{5}^{\text {out }}\right)}{w_{1}^{\prime}+w_{2}^{\prime}+w_{3}^{\prime}+\epsilon}\right)\end{aligned}$$

- NAS-FPN (Neural Architecture Search)
    - Motivation
        - ìœ„ì—ì„œ í–ˆë˜ ë‹¤ì–‘í•œ êµ¬ì¡°ë¥¼ ë” íš¨ìœ¨ì ìœ¼ë¡œ ì°¾ì•„ë³´ì!
        - ê°€ì¥ ì í•©í•œ FPNêµ¬ì¡°ë¥¼ ë”¥ëŸ¬ë‹ì„ í†µí•´ íƒìƒ‰í•´ë³´ì
    - Architecture
        
        ![Untitled](/assets/images/AI-Images2/lv2_week2_4/img21.png){: width="50%" height="50%"}  
        
        ![Untitled](/assets/images/AI-Images2/lv2_week2_4/img22.png){: width="50%" height="50%"}  
        
        ![Untitled](/assets/images/AI-Images2/lv2_week2_4/img23.png){: width="50%" height="50%"}  
        
    - ë‹¨ì 
        - COCO dataset, ResNet ê¸°ì¤€ìœ¼ë¡œ ì°¾ì€ architecture, ë²”ìš©ì ì´ì§€ ëª»í•¨
            - Parameter ë§ì´ ì†Œëª¨
        
    - ê´€ë ¨ ì˜ìƒ & ë…¼ë¬¸
        - [https://www.youtube.com/watch?v=FAAt0jejWOA](https://www.youtube.com/watch?v=FAAt0jejWOA)
        - [https://arxiv.org/pdf/1904.07392.pdf](https://arxiv.org/pdf/1904.07392.pdf)
        - NAS ê´€ë ¨ ë§í¬ [https://ahn1340.github.io/neural architecture search/2021/04/26/NAS.html](https://ahn1340.github.io/neural%20architecture%20search/2021/04/26/NAS.html)
        

- Aug-FPN
    - Motivation - Problems in FPN
        - ì„œë¡œ ë‹¤ë¥¸ levelì˜ feature ê°„ì— semantic ì°¨ì´
        - Highest feature mapì˜ ì •ë³´ ì†ì‹¤ (ìœ„ì—ì„œ ì˜¤ëŠ” featureê°€ ì—†ê³  ë‹¨ìˆœ convë§Œ ì§„í–‰)
        - 1ê°œì˜ feature mapì—ì„œ RoI ìƒì„± (PANetì—ì„œ ì–´ëŠ ì •ë„ í•´ê²°) (?)
        
        ![Untitled](/assets/images/AI-Images2/lv2_week2_4/img24.png){: width="50%" height="50%"}  
        
    - ì£¼ìš” êµ¬ì„±
        - Consistent Supervision
        - Residual Feature Augmentation
        - Soft RoI Selection
        
    - Resiual Feature Augmentation
        - M6 feature (highest level featureë¥¼ ì¶”ê°€)
            
            ![Untitled](/assets/images/AI-Images2/lv2_week2_4/img25.png){: width="50%" height="50%"}  
            
        - Adaptive Poolingì„ í†µí•´ì„œ Target featureì˜ sizeë¥¼ ë‹¤ì–‘í•œ í¬ê¸°ë¡œ ë§Œë“¤ì–´ì¤€ë‹¤. ê·¸ í›„, Adaptive Spatial Fusionì„ ìœ„í•´ì„œ 256 channelsë¡œ ë§ì¶°ì¤€ë‹¤.
            
            (ì§ˆë¬¸) Adaptive Spatial Fusionì´ í•œë²ˆ ë” ì¼ì–´ë‚œë‹¤ëŠ” ëœ»ì¸ê°€?
            
            ![Untitled](/assets/images/AI-Images2/lv2_week2_4/img26.png){: width="50%" height="50%"}  
            
        - Adaptive Spatial Fusionì€ Transformerì™€ ìœ ì‚¬í•œ ê³¼ì •ìœ¼ë¡œ ì†Œê°œ, 
        3ê°œì˜ feature mapì„ upsample í›„, concatí•˜ê³  ê° layerë¥¼ í†µí•´ N x (1 x h x w)ë¥¼ ë§Œë“¤ì–´ì¤€ë‹¤. ì—¬ê¸°ì„œ ë§Œë“¤ì–´ì§„ ê°’ì€ **Spatil weight(ë¶‰ì€ ë°•ìŠ¤)**ë¥¼ ì˜ë¯¸í•˜ê³  ì—¬ê¸°ì— **Nê°œì˜ feature**ë¥¼ ê³±í•´ì„œ ê°€ì¤‘ summationì„ í•œë‹¤.
            
          ![Untitled](/assets/images/AI-Images2/lv2_week2_4/img27.png){: width="50%" height="50%"}  
            
    - Soft RoI Selection
        - FPN ê³¼ ê°™ì´ í•˜ë‚˜ì˜ feature map ì—ì„œ RoI ë¥¼ ê³„ì‚°í•˜ëŠ” ê²½ìš° sub optimal
        - ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ PANet ì—ì„œ ëª¨ë“  feature map ì„ ì´ìš©í–ˆì§€ë§Œ , max pool í•˜ì—¬ ì •ë³´ ì†ì‹¤ ê°€ëŠ¥ì„±
        - ì´ë¥¼ í•´ê²°í•˜ê¸° ìœ„í•´ Soft RoI Selection ì„ ì„¤ê³„
        
          ![Untitled](/assets/images/AI-Images2/lv2_week2_4/img28.png){: width="50%" height="50%"}  
        
        - PANet ì˜ max poolingì„ í•™ìŠµ ê°€ëŠ¥í•˜ë„ë¡ weight mutilplyí•´ì¤€ë‹¤.

### ê³¼ì œ  

## 3. í”¼ì–´ì„¸ì…˜ ì •ë¦¬

## 4. í•™ìŠµ íšŒê³ 

- 